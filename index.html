<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Willy2Go</title>
    <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Inter' rel='stylesheet'>

    <style>
        body {
            font-family: Roboto Mono;
            background-color: #4B0082;
            color: #FFD700;
            margin: 0;
            padding: 0;
        }

        header {
            text-align: center;
            padding: 7px;
            background-color: #6A0DAD;
            border-radius: 15px;
            color: #efbf04;
        }

        header h1 {
            margin: 0;
            text-align: center;
            font-family: Montserrat
        }

        header img.align-left {
            position: absolute;
            left: 15px;
            top: 35px;
        }

        header img.align-right {
            position: absolute;
            right: 15px;
            top: auto;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #E6E6FA;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .container h2 {
            color: #4B0082;
            border-radius: 10px;
        }

        .header-image {
            background-color: transparent;
            /* Removes background */
            border: none;
            /* Removes any borders */
        }

        .image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            /* Add spacing between the images */
            margin-top: 10px;
            /* Space between the text and the images */
        }

        #cartItems {
            list-style: none;
            /* Remove bullets */
            padding: 0;
            /* Remove left indentation */
            margin: 0;
            color: #4B0082;
            /* Ensure no extra space */
            font-size: 20px;
        }

        #cartItems div {
            text-align: left;
            /* Ensure text aligns to the left */
            margin-bottom: 5px;
            /* Optional: Add space between items */
        }

        .menu-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .menu-table th,
        .menu-table td {
            border: none;
            /* Remove borders */
            padding: 10px;
            text-align: center;
            font-family: Inter;
        }

        .menu-table th {
            background-color: #6A0DAD;
            color: #FFD700;
            font-family: Inter;
        }

        .menu-table th:nth-child(3),
        .menu-table td:nth-child(3) {
            width: 200px;
            /* Set a fixed width for the Quantity column */
        }

        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .form-group label {
            flex: 2;
            margin-bottom: 5px;
            color: #4B0082;
            font-family: Georgia;
        }

        .quantity-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            /* Center align the buttons and input */
            gap: 5px;
            /* Add consistent spacing between buttons and input */
        }

        .quantity-wrapper button {
            width: 30px;
            height: 30px;
            background-color: #FFD700;
            border: none;
            border-radius: 5px;
            color: #4B0082;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .quantity-wrapper button:hover {
            background-color: #E6BE8A;
        }

        .quantity-wrapper input {
            width: 50px;
            text-align: center;
            padding: 5px;
            border: 1px solid #6A0DAD;
            border-radius: 5px;
            font-size: 16px;
            color: #4B0082;
            margin: 0 5px;
        }

        #cartItems li {
            color: #4B0082;
            /* Purple color */
            font-family: Georgia;
        }

        .menu-table td {
            color: #4B0082;
            /* Purple color */
            font-family: Inter;
        }

        .quantity-wrapper input::placeholder {
            color: gray;
            /* Placeholder color */
            text-align: center;
            /* Center placeholder text */
        }

        .quantity-wrapper input[type="number"] {
            appearance: textfield;
            /* Removes number spinner for better alignment */
        }

        .quantity-wrapper input[type="number"]::-webkit-inner-spin-button,
        .quantity-wrapper input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            /* Hides spinner in Chrome, Safari, Edge */
            margin: 0;
            /* Ensures no extra margin is applied */
            font-family: Inter;
        }

        #totalCost {
            font-size: 1.5rem;
            color: #4B0082;
            text-align: center;
            margin-top: 15px;
        }

        .submit-btn {
            width: 100%;
            padding: 10px;
            background-color: #FFD700;
            color: #4B0082;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background-color: #E6BE8A;
        }

        select {
            flex: 0.6;
            width: 100%;
            /* Adjust width */
            height: 28px;
            /* Adjust height */
            padding: 5px;
            /* Add padding for better appearance */
            border: 1px solid gray;
            border-radius: 5px;
            font-size: 13px;
            /* Control text size within the dropdown */
            color: gray;
            /* Text color */
            background-color: #FFFFFF;
            /* Background color */
            font-family: Georgia;
        }

        select:focus,
        select:valid {
            color: black;
        }

        footer {
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            background-color: #6A0DAD;
            color: #FFD700;
        }

        /* Sticky Navbar */
        .navbar {
            display: flex;
            justify-content: space-around;
            background-color: #4B0082;

            top: 0;
            width: 100%;
            color: white;
            z-index: 1000;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
        }

        .navbar a:hover {
            background-color: #575757;
        }

        /* Table Styling */
        .table-container {
            margin-top: 60px;
            /* Prevent overlap with fixed navbar */
            display: flex;
            justify-content: center;
        }

        table {
            width: 80%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th,
        td {
            border: 1px solid black;
            padding: 10px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        /* Offset for fixed navbar */
        tr:before {
            content: "";
            display: block;
            height: 60px;
            /* Adjust based on navbar height */
            margin-top: -60px;
            visibility: hidden;
        }
    </style>
</head>

<body>
    <header>
        <div class="image-container">
            <img src="images/PurpleWilly.png" alt="WillyGo Logo" class="header-image"
                style="width:250px; height: auto;">
        </div>
        <h4 style="font-family: Inter;">Order your McDonald's favorites in seconds!</h4>
    </header>

    <div class="container">
        <header>
            <h1 style="font-family:Montserrat"> Enter Your Order</h1>
        </header>
        <div class="image-container">
            <img src="images/McDonalds.jpg" alt="McDonald's Logo" class="header-image"
                style="width:130px; height: auto;">
        </div>
        <div style="display: flex; justify-content: center; gap: 50px;">
            <div style="font-family: Inter; color: #6A0DAD; text-align: left; font-size: 26px;">
                <h3>Open:</h3>
                <h4 style="font-size: 22px;">Friday: 8:00 PM - 2:30 AM</h4>
                <h4 style="font-size: 22px;">Saturday: 8:00 PM - 2:30 AM</h4>
            </div>

            <div style="font-family: Inter; color: #6A0DAD; text-align: left; font-size: 26px;">
                <h3>Add delivery explanation section</h3>
                <h4 style="font-size: 22px;">Deliveries are made within ...</h4>
                <h4 style="font-size: 22px;">*will send you what to put in this section*</h4>
            </div>
        </div>
        <hr>
        <div class="form-group">
            <label for="Name" style="font-family: Inter;">Name:</label>
            <input placeholder="Enter Name">
        </div>
        <div class="form-group">
            <label for="Dorm" style="font-family: Inter;">Residence:</label>
            <select style="font-family: Inter;" id="Dorm" name="Dorm" required>
                <option value="" disabled selected>Select Your Residence</option>
                <option value="Agard">Agard</option>
                <option value="Brooks">Brooks</option>
                <option value="Bryant">Bryant</option>
                <option value="Carter">Carter</option>
                <option value="Currier">Currier</option>
                <option value="Dodd">Dodd</option>
                <option value="East">East</option>
                <option value="Fayerweather">Fayerweather</option>
                <option value="Fitch">Fitch</option>
                <option value="Garfield">Garfield</option>
                <option value="Gladden">Gladden</option>
                <option value="Goff's">Goff's</option>
                <option value="Goodrich">Goodrich</option>
                <option value="Horn">Horn</option>
                <option value="Hubbell">Hubbell</option>
                <option value="Images">Images</option>
                <option value="Lehman">Lehman</option>
                <option value="Mark Hopkins">Mark Hopkins</option>
                <option value="Mission">Mission</option>
                <option value="Morgan">Morgan</option>
                <option value="Perry">Perry</option>
                <option value="Prospect">Prospect</option>
                <option value="Sage">Sage</option>
                <option value="Sewall">Sewall</option>
                <option value="Sushi Thai">Sushi Thai</option>
                <option value="Spencer">Spencer</option>
                <option value="Thompson">Thompson</option>
                <option value="Tyler">Tyler</option>
                <option value="Tyler Annex">Tyler Annex</option>
                <option value="West">West</option>
                <option value="Willy">Williams (Willy)</option>
                <option value="Wood">Wood</option>
                <option value="66 Hoxsey">66 Hoxsey</option>
                <option value="70 Hoxsey">70 Hoxsey</option>
                <option value="71 Hoxsey">71 Hoxsey</option>

            </select>

        </div>
        <div class="form-group">
            <label style="font-family: Inter;" for="phoneNumber">Phone Number:</label>
            <input type="text" id="phoneNumber" name="phoneNumber" placeholder="Enter Phone Number" maxlength="16">
        </div>
        <div class="form-group">
            <label style="font-family: Inter;" for="emailAddress">Email:</label>
            <input type="text" id="emailAddress" name="emailAddress" placeholder="Enter Email Address" maxlength="30">
        </div>
        <hr>
        <nav class="navbar">
            <a href="#sandwiches">Sandwiches</a>
            <a href="#nuggets-fries">Nuggets & Fries</a>
            <a href="#drinks">Drinks</a>
            <a href="#sweets">Sweets & Treats</a>
            <a href="#condiments">Condiments</a>
        </nav>
        <form id="orderForm" action="/.netlify/functions/create-checkout-session" method="POST">
            <table class="menu-table">
                <tbody>
                    <tr id="sandwiches">
                        <td colspan="2"
                            style="font-size: 22px; text-align: center; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Sandwiches
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/big_mac.jpeg" alt="Big Mac" width="100" height="100"
                                style="vertical-align: middle;"><br>
                            Big Mac<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$8.29</div>

                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('bigMac', -1)">-</button>
                                <input type="number" id="bigMac" name="bigMac" placeholder="0" value="0" min="0"
                                    data-price="8.29" readonly>
                                <button type="button" onclick="adjustQuantity('bigMac', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/quarter_pounder.jpeg" alt="Quarter Pounder" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Quarter Pounder<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$8.09</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('quarterPounder', -1)">-</button>
                                <input type="number" id="quarterPounder" name="quarterPounder" placeholder="0" value="0"
                                    min="0" data-price="8.09" readonly>
                                <button type="button" onclick="adjustQuantity('quarterPounder', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/double_quarter_pounder.jpg" alt="Double Quarter Pounder" width="100"
                                height="100" style="vertical-align: middle;"><br>
                            Double Quarter Pounder<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$8.99</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('doubleQuarterPounder', -1)">-</button>
                                <input type="number" id="doubleQuarterPounder" name="doubleQuarterPounder"
                                    placeholder="0" value="0" min="0" data-price="8.99" readonly>
                                <button type="button" onclick="adjustQuantity('doubleQuarterPounder', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/cheeseburger.jpg" alt="cheeseburger" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Cheeseburger<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$3.79</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('cheeseburger', -1)">-</button>
                                <input type="number" id="cheeseburger" name="cheeseburger" placeholder="0" value="0"
                                    min="0" data-price="3.79" readonly>
                                <button type="button" onclick="adjustQuantity('cheeseburger', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/mcdouble.jpg" alt="mcDouble" width="150" height="100"
                                style="vertical-align: middle;"><br>
                            McDouble<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$3.59</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('mcDouble', -1)">-</button>
                                <input type="number" id="mcDouble" name="mcDouble" placeholder="0" value="0" min="0"
                                    data-price="3.59" readonly>
                                <button type="button" onclick="adjustQuantity('mcDouble', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/hamburger.jpg" alt="hamburger" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Hamburger<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$3.09</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('hamburger', -1)">-</button>
                                <input type="number" id="hamburger" name="hamburger" placeholder="0" value="0" min="0"
                                    data-price="3.09" readonly>
                                <button type="button" onclick="adjustQuantity('hamburger', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/mc_crispy.jpg" alt="McCrispy" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            McCrispy
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$7.69</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('mcCrispy', -1)">-</button>
                                <input type="number" id="mcCrispy" name="mcCrispy" placeholder="0" value="0" min="0"
                                    data-price="7.69" readonly>
                                <button type="button" onclick="adjustQuantity('mcCrispy', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr id="nuggets-fries">
                        <td colspan="2"
                            style="font-size: 22px; text-align: center; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Nuggets & Fries
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/4_Mc_Nuggets.jpg" alt="4PcMcNuggets" width="150" height="100"
                                style="vertical-align: middle;"><br>
                            4pc McNuggets<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$4.49</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('4PcMcNuggets', -1)">-</button>
                                <input type="number" id="4PcMcNuggets" name="4PcMcNuggets" placeholder="0" min="0"
                                    value="0" data-price="4.49" readonly>
                                <button type="button" onclick="adjustQuantity('4PcMcNuggets', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/mc_nuggets.jpg" alt="6PcMcNuggets" width="150" height="100"
                                style="vertical-align: middle;"><br>
                            6pc McNuggets<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$5.89</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('6PcMcNuggets', -1)">-</button>
                                <input type="number" id="6PcMcNuggets" name="6PcMcNuggets" placeholder="0" min="0"
                                    value="0" data-price="5.89" readonly>
                                <button type="button" onclick="adjustQuantity('6PcMcNuggets', 1)">+</button>
                            </div>
                        </td>

                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/10_Mc_Nuggets.jpg" alt="10PcMcNuggets" width="150" height="100"
                                style="vertical-align: middle;"><br>
                            10pc McNuggets<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$8.19</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('10PcMcNuggets', -1)">-</button>
                                <input type="number" id="10PcMcNuggets" name="10mcNuggets" placeholder="0" min="0"
                                    value="0" data-price="8.19" readonly>
                                <button type="button" onclick="adjustQuantity('10PcMcNuggets', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/20_mcnuggets.jpg" alt="20PcMcNuggets" width="150" height="100"
                                style="vertical-align: middle;"><br>
                            20pc McNuggets<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$10.98</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('20PcMcNuggets', -1)">-</button>
                                <input type="number" id="20PcMcNuggets" name="20PcMcNuggets" placeholder="0" min="0"
                                    value="0" data-price="10.89" readonly>
                                <button type="button" onclick="adjustQuantity('20PcMcNuggets', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/french_fries.jpg" alt="fries" width="100" height="100"
                                    style="vertical-align: middle;">
                                Fries<br>
                                <select style="font-family: Inter; max-width: 90px;" id="friesSize"
                                    onchange="updatePriceAndQuantity('fries', 'friesSize')">
                                    <option value="4.79" data-size="Small">S ($4.79)</option>
                                    <option value="5.79" data-size="Medium">M ($5.79)</option>
                                    <option value="6.69" data-size="Large">L ($6.69)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('fries', -1)">-</button>
                                        <input type="number" id="fries" name="fries" placeholder="0" min="0" value="0"
                                            size="small" data-price="4.79" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('fries', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr id="drinks">
                        <td colspan="2"
                            style="font-size: 22px; text-align: center; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Drinks
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/sprite.jpeg" alt="sprite" width="100" height="150"
                                    style="vertical-align: middle;">
                                Sprite<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="spriteSize"
                                    onchange="updatePriceAndQuantity('sprite', 'spriteSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>

                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('sprite', -1)">-</button>
                                        <input type="number" id="sprite" name="sprite" placeholder="0" min="0" value="0"
                                            data-price="2.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('sprite', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/coca_cola.jpg" alt="cocaCola" width="100" height="150"
                                    style="vertical-align: middle;">
                                Coca-Cola<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="cocaColaSize"
                                    onchange="updatePriceAndQuantity('cocaCola', 'cocaColaSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>

                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('cocaCola', -1)">-</button>
                                        <input type="number" id="cocaCola" name="cocaCola" placeholder="0" min="0"
                                            value="0" data-price="4.79" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('cocaCola', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>

                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/diet_coke.jpg" alt="dietCoke" width="100" height="150"
                                    style="vertical-align: middle;">
                                Diet Coke<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="dietCokeSize"
                                    onchange="updatePriceAndQuantity('dietCoke', 'dietCokeSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>

                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('dietCoke', -1)">-</button>
                                        <input type="number" id="dietCoke" name="dietCoke" placeholder="0" min="0"
                                            value="0" data-price="4.79" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('dietCoke', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/dr_pepper.jpg" alt="drPepper" width="100" height="150"
                                    style="vertical-align: middle;">
                                Dr.Pepper<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="drPepperSize"
                                    onchange="updatePriceAndQuantity('drPepper', 'drPepperSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>

                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('drPepper', -1)">-</button>
                                        <input type="number" id="drPepper" name="drPepper" placeholder="0" min="0"
                                            value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('drPepper', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/root_beer.jpg" alt="rootBeer" width="100" height="150"
                                    style="vertical-align: middle;">
                                Root Beer<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="drPepperSize"
                                    onchange="updatePriceAndQuantity('drPepper', 'drPepperSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>

                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('rootBeer', -1)">-</button>
                                        <input type="number" id="rootBeer" name="rootBeer" placeholder="0" min="0"
                                            value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('rootBeer', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/fanta.jpg" alt="rootBeer" width="100" height="150"
                                    style="vertical-align: middle;">
                                Fanta<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="fantaSize"
                                    onchange="updatePriceAndQuantity('fanta', 'fantaSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('fanta', -1)">-</button>
                                        <input type="number" id="fanta" name="fanta" placeholder="0" min="0" value="0"
                                            data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('fanta', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/lemonade.jpg" alt="minuteMaidLemonade" width="120" height="120"
                                    style="vertical-align: middle;">
                                Minute Maid Lemonade<br>
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$2.79</div>
                                <select style="font-family: Inter; max-width: 90px;" id="fantaSize"
                                    onchange="updatePriceAndQuantity('fanta', 'fantaSize')">
                                    <option value="2.79" data-size="Small">S</option>
                                    <option value="2.79" data-size="Medium">M</option>
                                    <option value="2.79" data-size="Large">L</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button"
                                            onclick="adjustQuantity('minuteMaidLemonade', -1)">-</button>
                                        <input type="number" id="minuteMaidLemonade" name="minuteMaidLemonade"
                                            placeholder="0" min="0" value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button"
                                            onclick="adjustQuantity('minuteMaidLemonade', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/bottled_water.jpg" alt="dasaniWaterBottle" width="115" height="125"
                                    style="vertical-align: middle;">
                                Dasani Water Bottle
                                <div style="font-size: 14px; font-style: italic ;width: 100%;">$3.29</div>
                                <div style="font-size: 17px; color: #E6E6FA;font-style: italic ;width: 100%;">None</div>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button"
                                            onclick="adjustQuantity('dasaniWaterBottle', -1)">-</button>
                                        <input type="number" id="dasaniWaterBottle" name="dasaniWaterBottle"
                                            placeholder="0" min="0" value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button"
                                            onclick="adjustQuantity('dasaniWaterBottle', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr id="sweets">
                        <td colspan="2"
                            style="font-size: 22px; text-align: center; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Sweets & Treats
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <div style="font-size: 2px; color: #E6E6FA;font-style: italic ;width: 100%;">None</div>
                                <img src="images/m&m_mcflurry.jpg" alt="m&mMcFlurry" width="100" height="100"
                                    style="vertical-align: middle;">
                                M&M McFlurry<br>
                                <select style="font-family: Inter; max-width: 90px;" id="m&mMcFlurrySize"
                                    onchange="updatePriceAndQuantity('m&mMcFlurry', 'm&mMcFlurrySize')">
                                    <option value="6.19" data-size="Regular">Regular ($6.19)</option>
                                    <option value="3.99" data-size="Mini">Mini ($3.99)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('m&mMcFlurry', -1)">-</button>
                                        <input type="number" id="m&mMcFlurry" name="m&mMcFlurry" placeholder="0" min="0"
                                            value="0" data-price="4.79" size="Regular" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('m&mMcFlurry', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/oreo_mcflurry.jpg" alt="oreoMcFlurry" width="100" height="100"
                                    style="vertical-align: middle;">
                                Oreo McFlurry<br>
                                <select style="font-family: Inter; max-width: 90px;" id="oreoMcFlurrySize"
                                    onchange="updatePriceAndQuantity('oreoMcFlurry', 'oreoMcFlurrySize')">
                                    <option value="6.19" data-size="Regular">Regular ($6.19)</option>
                                    <option value="3.99" data-size="Mini">Mini ($3.99)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('oreoMcFlurry', -1)">-</button>
                                        <input type="number" id="oreoMcFlurry" name="oreoMcFlurry" placeholder="0"
                                            min="0" value="0" data-price="4.79" size="Small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('oreoMcFlurry', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <div style="font-size: 19px; color: #E6E6FA;font-style: italic ;width: 100%;">None</div>
                                <img src="images/shamrock_mcflurry.jpg" alt="shamrockMcFlurry" width="100" height="100"
                                    style="vertical-align: middle;">
                                Shamrock McFlurry<br>
                                <select style="font-family: Inter; max-width: 90px;" id="shamrockMcFlurrySize"
                                    onchange="updatePriceAndQuantity('shamrockMcFlurry', 'shamrockMcFlurrySize')">
                                    <option value="4.79" data-size="Small">S ($4.79)</option>
                                    <option value="5.79" data-size="Medium">M ($5.79)</option>
                                    <option value="7.09" data-size="Large">L ($7.09)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button"
                                            onclick="adjustQuantity('shamrockMcFlurry', -1)">-</button>
                                        <input type="number" id="shamrockMcFlurry" name="shamrockMcFlurry"
                                            placeholder="0" min="0" value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('shamrockMcFlurry', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/choco_Shake.jpg" alt="chocoShake" width="75" height="125"
                                    style="vertical-align: middle;">
                                Chocolate Shake<br>
                                <select style="font-family: Inter; max-width: 90px;" id="chocoShakeSize"
                                    onchange="updatePriceAndQuantity('chocoShake', 'chocoShakeSize')">
                                    <option value="5.59" data-size="Small">S ($5.59)</option>
                                    <option value="6.19" data-size="Medium">M ($6.19)</option>
                                    <option value="6.59" data-size="Large">L ($6.59)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('chocoShake', -1)">-</button>
                                        <input type="number" id="chocoShake" name="chocoShake" placeholder="0" min="0"
                                            value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('chocoShake', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/strawberry_shake.jpg" alt="strawberryShake" width="75" height="125"
                                    style="vertical-align: middle;">
                                Strawberry Shake<br>
                                <select style="font-family: Inter; max-width: 90px;" id="strawberryShakeSize"
                                    onchange="updatePriceAndQuantity('strawberryShake', 'strawberryShakeSize')">
                                    <option value="5.59" data-size="Small">S ($5.59)</option>
                                    <option value="6.19" data-size="Medium">M ($6.19)</option>
                                    <option value="6.59" data-size="Large">L ($6.59)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('strawberryShake', -1)">-</button>
                                        <input type="number" id="strawberryShake" name="strawberryShake" placeholder="0"
                                            min="0" value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('strawberryShake', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/vanilla_shake.jpg" alt="vanillaShake" width="75" height="125"
                                    style="vertical-align: middle;">
                                Vanilla Shake<br>
                                <select style="font-family: Inter; max-width: 90px;" id="vanillaShakeSize"
                                    onchange="updatePriceAndQuantity('vanillaShake', 'vanillaShakeSize')">
                                    <option value="5.59" data-size="Small">S ($5.59)</option>
                                    <option value="6.19" data-size="Medium">M ($6.19)</option>
                                    <option value="6.59" data-size="Large">L ($6.59)</option>
                                </select>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">

                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('vanillaShake', -1)">-</button>
                                        <input type="number" id="vanillaShake" name="vanillaShake" placeholder="0"
                                            min="0" value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('vanillaShake', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <br><br>
                            <div
                                style="text-align: center; display: flex; flex-direction: column; align-items: center;">
                                <img src="images/apple_pie.jpg" alt="applePie" width="150" height="80"
                                    style="vertical-align: middle;">
                                Apple Pie <br><br>
                                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 5px;">
                                    <div class="quantity-wrapper" style="display: flex; align-items: center; gap: 2px;">
                                        <button type="button" onclick="adjustQuantity('applePie', -1)">-</button>
                                        <input type="number" id="applePie" name="applePie" placeholder="0" min="0"
                                            value="0" data-price="4.79" size="small" readonly
                                            style="text-align: center; width: 40px;">
                                        <button type="button" onclick="adjustQuantity('applePie', 1)">+</button>
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr id="sweets">
                        <td colspan="2"
                            style="font-size: 22px; text-align: center; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Condiments
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/ketchup.jpg" alt="Ketchup" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Ketchup<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$0.25</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('ketchup', -1)">-</button>
                                <input type="number" id="ketchup" name="ketchup" placeholder="0" value="0" min="0"
                                    data-price="0.25" readonly>
                                <button type="button" onclick="adjustQuantity('ketchup', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/sweet_n_sour_sauce.jpg" alt="sweetNSourSauce" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Sweet 'N Sour<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$0.25</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('sweetNSourSaucee', -1)">-</button>
                                <input type="number" id="sweetNSourSauce" name="sweetNSourSauce" placeholder="0"
                                    value="0" min="0" data-price="0.25" readonly>
                                <button type="button" onclick="adjustQuantity('sweetNSourSauce', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/bbq_sauce.jpg" alt="tangyBarbecueSauce" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Tangy BBQ<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$0.25</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('tangyBarbecueSauce', -1)">-</button>
                                <input type="number" id="tangyBarbecueSauce" name="tangyBarbecueSauce" placeholder="0"
                                    value="0" min="0" data-price="0.25" readonly>
                                <button type="button" onclick="adjustQuantity('tangyBarbecueSauce', 1)">+</button>
                            </div>
                        </td>
                        <td style="font-weight: bold;">
                            <img src="images/ranch.jpg" alt="ranch" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Ranch<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$0.25</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('ranch', -1)">-</button>
                                <input type="number" id="ranch" name="ranch" placeholder="0" value="0" min="0"
                                    data-price="0.25" readonly>
                                <button type="button" onclick="adjustQuantity('ranch', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td style="font-weight: bold;">
                            <img src="images/spicy_buffalo_sauce.jpg" alt="spicyBuffaloSauce" width="125" height="100"
                                style="vertical-align: middle;"><br>
                            Spicy Buffalo Sauce<br>
                            <div style="font-size: 14px; font-style: italic ;width: 100%;">$0.25</div>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('spicyBuffaloSaucee', -1)">-</button>
                                <input type="number" id="spicyBuffaloSauce" name="spicyBuffaloSauce" placeholder="0"
                                    value="0" min="0" data-price="0.25" readonly>
                                <button type="button" onclick="adjustQuantity('spicyBuffaloSauce', 1)">+</button>
                            </div>
                        </td>
                                            </tr>
                    <tr>
                        <td colspan="2"
                            style="font-size: 22px; text-align: left; font-weight: bold; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Please Tip Our Drivers!
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <label for="tipAmount" style="font-size: 16px; color: #4B0082;">Tip Amount ($):</label>
                        </td>
                        <td>

                            <input type="text" id="tipAmount" name="tipAmount" placeholder="0.00"
                                style="width: 80px; text-align: center; padding: 5px; align-items: right;border: 1px solid #6A0DAD; border-radius: 5px; font-size: 16px; color: #4B0082; appearance: none; -moz-appearance: textfield;">
                            </input>
                        </td>
                    </tr>

                </tbody>
            </table>
            <h3 style="font-family: Inter;color: #6A0DAD;">Current Cart</h3>
            <ul id="cartItems"></ul>
            <div id="totalCost"></div>
            <hr>
            <button type="button" class="submit-btn" id="checkout-button" onclick="submitOrder(event)">Proceed with
                Payment</button>
        </form>

    </div>

    <footer>
        <p> 2025 Willy2Go</p>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        emailjs.init("P-flo4QhLrSH5apSe"); // Replace with your actual EmailJS Public Key
    </script>

    <script>
        // General object to store product quantities
        const cart = {};

        function updateProductFlavor(product, productFlavor) {
            const productFlavorSelect = document.getElementById(productFlavor);
            productFlavorSelect.addEventListener("change", function () {
                const selectedFlavorOption = this.options[this.selectedIndex];
                const flavor = selectedFlavorOption.getAttribute("data-flavor"); // Get selected flavor
                const sodaInput = document.getElementById(product);

                // Update the name attribute dynamically based on flavor
                const newItemId = `${product}_${flavor}`;


                // Fetch the current selected size
                const productSizeSelect = document.getElementById(product + "Size");
                const selectedSizeOption = productSizeSelect.options[productSizeSelect.selectedIndex];
                const size = selectedSizeOption.getAttribute("data-size");

                // Reset quantity to 0 if switching to a new flavor
                if (!(newItemId in cart) || !(size in cart[newItemId])) {
                    sodaInput.value = 0;
                } else {
                    sodaInput.value = cart[newItemId][size].quantity; // Retrieve quantity from cart if exists
                }

                // Ensure cart is structured correctly for new flavor
                if (!(newItemId in cart)) {
                    cart[newItemId] = {};
                }
                if (!(size in cart[newItemId])) {
                    cart[newItemId][size] = { price: parseFloat(selectedSizeOption.value), quantity: 0 };
                }

                // Update price and quantity based on size
                updatePriceAndQuantity(newItemId, product + "Size");
            });
        }

        // Ensure the function runs on page load to initialize correct values
        updateProductFlavor();

        function updatePriceAndQuantity(itemId, itemSizeId) {
            const optionElement = document.getElementById(itemSizeId);
            const selectedOption = optionElement.options[optionElement.selectedIndex];
            const value = parseFloat(selectedOption.value);  // Price of the selected size
            const size = selectedOption.getAttribute('data-size');  // Size (like '10pc', '20pc', etc.)

            const itemElement = document.getElementById(itemId);
            const itemKey = itemElement.name;  // Use the name attribute as the key
            itemElement.setAttribute('data-price', value);  // Update price

            if (!(itemKey in cart)) {
                cart[itemKey] = {};
            }

            // Initialize the size with quantity 0 if not present in cart
            if (!(size in cart[itemKey])) {
                cart[itemKey][size] = { "price": value, "quantity": 0 };
            }

            // Set input field value to the quantity stored in cart
            itemElement.value = cart[itemKey][size].quantity;
        }

        function adjustQuantity(itemId, quantityChange) {
            const inputElement = document.getElementById(itemId);

            // Check if there's an associated flavor dropdown
            const flavorDropdown = document.getElementById(itemId + "Flavor");
            if (flavorDropdown) {
                const selectedFlavorOption = flavorDropdown.options[flavorDropdown.selectedIndex];

                if (!selectedFlavorOption || !selectedFlavorOption.getAttribute("data-flavor")) {
                    alert(`Please select a valid flavor for ${itemId} before adjusting quantity.`);
                    return; // Prevent quantity change
                }
            }

            let currentValue = parseInt(inputElement.value, 10);
            currentValue += quantityChange;
            if (currentValue < 0) {
                currentValue = 0; // Prevent negative values
            }

            inputElement.value = currentValue;
            updateCart(itemId);
        }

        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItems');
            cartItemsList.innerHTML = ''; // Clear previous items

            for (let itemKey in cart) {
                const itemData = cart[itemKey];

                if (!('quantity' in itemData)) {
                    for (let size in itemData) {
                        const sizeData = itemData[size];
                        if (sizeData.quantity > 0) {
                            const itemDiv = document.createElement('div');
                            itemDiv.textContent = `${size} ${formatItemName(itemKey)}: ${sizeData.quantity} x $${sizeData.price.toFixed(2)}`;
                            cartItemsList.appendChild(itemDiv);
                        }
                    }
                } else {
                    if (itemData.quantity > 0) {
                        const itemDiv = document.createElement('div');
                        itemDiv.textContent = `${formatItemName(itemKey)}: ${itemData.quantity} x $${itemData.price.toFixed(2)}`;
                        cartItemsList.appendChild(itemDiv);
                    }
                }
            }

            updateTotalCost();  // Ensure total updates whenever the cart updates
        }

        // Helper function to format item names (capitalize first letter)
        function formatItemName(itemKey) {
            if (/^Mc[A-Z]/.test(itemKey)) {
                return itemKey;
            }

            return itemKey
                // Handle "sweetNSourSauce" -> "Sweet N Sour Sauce"
                .replace(/([a-z])([N])([A-Z])/g, '$1 N $3') // Add spaces around 'N' if surrounded by lowercase & uppercase
                // Capitalize "mc" at the start of a word (e.g., "mcDouble"  "McDouble")
                .replace(/\bmc([A-Z])/g, 'Mc$1')
                // Ensure "Mc" stays connected to its following word
                .replace(/(Mc)([A-Z])/g, '$1 $2')
                // Insert spaces before uppercase letters that follow a lowercase letter
                .replace(/([a-z])([A-Z])/g, '$1 $2')
                // Insert spaces before numbers followed by letters
                .replace(/(\d)([A-Za-z])/g, '$1 $2')
                // Remove the space between "Mc " and the next word to restore "McNuggets", "McDouble", etc.
                .replace(/Mc (\w)/g, 'Mc$1')
                // Capitalize the first letter of each word except inside "McNuggets", "McDouble", etc.
                .replace(/\b(?!Mc)\w/g, (match) => match.toUpperCase());
        }

        function updateCart(itemId) {
            const inputElement = document.getElementById(itemId);
            const quantity = parseInt(inputElement.value, 10) || 0;
            const price = parseFloat(inputElement.getAttribute("data-price")) || 0;

            // Check if the item has a size dropdown (like McNuggets)
            const sizeDropdown = document.getElementById(itemId + "Size");
            let size = "";

            if (sizeDropdown) {
                const selectedSizeOption = sizeDropdown.options[sizeDropdown.selectedIndex];
                size = selectedSizeOption.getAttribute("data-size");

                if (!(itemId in cart)) {
                    cart[itemId] = {};
                }

                cart[itemId][size] = {
                    price: price,
                    quantity: quantity
                };
            } else {
                cart[itemId] = {
                    price: price,
                    quantity: quantity
                };
            }

            updateCartDisplay();
        }

        function calculateFee(totalPrice) {
            if (totalPrice <= 10) {
                return 4.00;
            } else if (totalPrice <= 20) {
                return 5.50;
            } else if (totalPrice <= 30) {
                return 6.00;
            } else if (totalPrice <= 40) {
                return 8.00;
            } else {
                return 10.00;
            }
        }

        function updateTotalCost() {
            let subTotal = 0;

            // Iterate through the cart to calculate the subtotal
            for (let itemKey in cart) {
                const itemData = cart[itemKey];

                if (itemData.quantity !== undefined && itemData.price !== undefined) {
                    subTotal += itemData.quantity * itemData.price;
                } else {
                    for (let size in itemData) {
                        const sizeData = itemData[size];
                        subTotal += sizeData.quantity * sizeData.price;
                    }
                }
            }

            const fee = calculateFee(subTotal);
            let tipAmount = parseFloat(document.getElementById("tipAmount").value.replace(/[^0-9.]/g, '')) || 0; // Remove non-numeric characters
            console.log("Updated Tip Amount:", tipAmount); // Debugging log

            const total = subTotal + fee + tipAmount;

            const totalCostElement = document.getElementById('totalCost');

            if (subTotal > 0) {
                totalCostElement.innerHTML = `
        <div style="display: flex; justify-content: space-between; font-size: 18px;">
            <span>Subtotal</span> <span>$${subTotal.toFixed(2)}</span>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 18px;">
            <span>Delivery Fee</span> <span>$${fee.toFixed(2)}</span>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 18px;">
            <span>Tip</span> <span>$${tipAmount.toFixed(2)}</span>
        </div>
        <div style="display: flex; justify-content: space-between; font-weight: bold;">
            <span>Total</span> <span>$${total.toFixed(2)}</span>
        </div>
        <textarea id="specialInstructions" name="specialInstructions" rows="4" cols="50" 
                  placeholder="Enter any special requests (e.g., no pickles, extra sauce)"></textarea>
        `;
            } else {
                totalCostElement.innerHTML = ''; // Clear display if cart is empty
            }
        }


        // Ensure the textarea is empty on page load
        document.addEventListener("DOMContentLoaded", function () {
            const specialInstructions = document.getElementById("specialInstructions");
            specialInstructions.value = "";  // Ensure the textarea is empty on load
        });

        async function submitOrder(event) {
            event.preventDefault(); // Prevent default form submission

            // Collect user details
            const name = document.querySelector('input[placeholder="Enter Name"]').value.trim();
            const residence = document.getElementById("Dorm").value;
            const phoneNumber = document.querySelector('input[placeholder="Enter Phone Number"]').value.trim();
            const userEmail = document.getElementById("emailAddress").value.trim();
            const tipAmount = parseFloat(document.getElementById("tipAmount").value) || 0;
            // const specialInstructions = document.getElementById("specialInstructions")?.value || "None";

            if (!name || !residence || !phoneNumber) {
                alert("Please fill out your name, residence, and phone number.");
                return;
            }

            let items = [];

            // Gather cart details
            for (let itemKey in cart) {
                const itemData = cart[itemKey];

                if (itemData.quantity !== undefined && itemData.quantity > 0) {
                    items.push({
                        name: formatItemName(itemKey),
                        price: itemData.price,
                        quantity: itemData.quantity
                    });
                } else {
                    for (let size in itemData) {
                        const sizeData = itemData[size];
                        if (sizeData.quantity > 0) {
                            items.push({
                                name: `${size} ${formatItemName(itemKey)}`,
                                price: sizeData.price,
                                quantity: sizeData.quantity
                            });
                        }
                    }
                }
            }

            if (items.length === 0) {
                alert("Your cart is empty!");
                return;
            }

            let orderDetails = [];
            for (let itemKey in cart) {
                const itemData = cart[itemKey];
                if (itemData.quantity > 0) {
                    orderDetails.push(`${itemData.quantity}x ${formatItemName(itemKey)}`);
                }
            }
            sessionStorage.setItem("emailData", JSON.stringify({
                to_email: "willy2godelivery@gmail.com",
                name: name,
                residence: residence,
                phone: phoneNumber,
                user_email: userEmail,
                special_instructions: document.getElementById("specialInstructions").value.trim() || "None", // Get value from textarea
                order_details: orderDetails.join("\n"), // Convert order details array into a newline-separated string
                total_cost: document.getElementById("totalCost").innerText.trim() // Convert total cost to plain text
            }));


            // Calculate delivery fee
            let subTotal = items.reduce((sum, item) => sum + item.price * item.quantity, 0);
            function calculateFee(totalPrice) {
                if (totalPrice <= 10) return 4.00;
                else if (totalPrice <= 20) return 5.50;
                else if (totalPrice <= 30) return 6.00;
                else if (totalPrice <= 40) return 8.00;
                else return 10.00;
            }
            const deliveryFee = calculateFee(subTotal);
            const total = subTotal + deliveryFee + tipAmount;

            console.log("Subtotal:", subTotal);
            console.log("Delivery Fee:", deliveryFee);
            console.log("Tip Amount:", tipAmount);
            console.log("Total Cost (to be sent to Stripe):", total);

            try {
                const response = await fetch("https://willy2go.onrender.com/create-checkout-session", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ items, delivery_fee: deliveryFee, tip_amount: tipAmount }), // Send tip to server
                });

                const session = await response.json();
                if (session.url) {
                    window.location.href = session.url;
                } else {
                    throw new Error("Stripe session URL missing");
                }
            } catch (error) {
                console.error("Payment error:", error);
                alert("Failed to proceed with payment.");
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            const tipInput = document.getElementById("tipAmount");

            function updateTipAndTotal() {
                let tipValue = tipInput.value.trim().replace(/[^0-9.]/g, ''); // Remove invalid characters
                tipInput.value = tipValue; // Ensure only valid values remain in input
                updateTotalCost(); // Recalculate total with new tip
            }

            // Attach event listeners for real-time updates
            tipInput.addEventListener("input", updateTipAndTotal);   // Detect typing changes
            tipInput.addEventListener("change", updateTipAndTotal);  // Detect pasting or losing focus
        });




    </script>

</body>

</html>