<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Willy2Go</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #4B0082;
            color: #FFD700;
            margin: 0;
            padding: 0;
        }

        header {
            text-align: center;
            padding: 7px;
            background-color: #6A0DAD;
            border-radius: 15px;
            color: #efbf04;
        }

        header h1 {
            margin: 0;
            text-align: center;
        }

        header img.align-left {
            position: absolute;
            left: 15px;
            top: 35px;
        }

        header img.align-right {
            position: absolute;
            right: 15px;
            top: auto;
        }

        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #E6E6FA;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .container h2 {
            color: #4B0082;
            border-radius: 10px;
        }

        .header-image {
            background-color: transparent;
            /* Removes background */
            border: none;
            /* Removes any borders */
        }

        .image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            /* Add spacing between the images */
            margin-top: 10px;
            /* Space between the text and the images */
        }

        .menu-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .menu-table th,
        .menu-table td {
            border: none;
            /* Remove borders */
            padding: 10px;
            text-align: center;
            font-family: Georgia;
        }

        .menu-table th {
            background-color: #6A0DAD;
            color: #FFD700;
        }

        .menu-table th:nth-child(3),
        .menu-table td:nth-child(3) {
            width: 200px;
            /* Set a fixed width for the Quantity column */
        }

        .form-group {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .form-group label {
            flex: 2;
            margin-bottom: 5px;
            color: #4B0082;
            font-family: Georgia;
        }

        .quantity-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            /* Center align the buttons and input */
            gap: 5px;
            /* Add consistent spacing between buttons and input */
        }

        .quantity-wrapper button {
            width: 30px;
            height: 30px;
            background-color: #FFD700;
            border: none;
            border-radius: 5px;
            color: #4B0082;
            font-size: 16px;
            cursor: pointer;
        }

        .quantity-wrapper button:hover {
            background-color: #E6BE8A;
        }

        .quantity-wrapper input {
            width: 50px;
            text-align: center;
            padding: 5px;
            border: 1px solid #6A0DAD;
            border-radius: 5px;
            font-size: 16px;
            color: #4B0082;
        }

        #cartItems li {
            color: #4B0082;
            /* Purple color */
            font-family: Georgia;
        }

        .menu-table td {
            color: #4B0082;
            /* Purple color */
            font-family: Georgia;
        }

        .quantity-wrapper input::placeholder {
            color: gray;
            /* Placeholder color */
            text-align: center;
            /* Center placeholder text */
        }

        .quantity-wrapper input[type="number"] {
            appearance: textfield;
            /* Removes number spinner for better alignment */
        }

        .quantity-wrapper input[type="number"]::-webkit-inner-spin-button,
        .quantity-wrapper input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            /* Hides spinner in Chrome, Safari, Edge */
            margin: 0;
            /* Ensures no extra margin is applied */
        }

        #totalCost {
            font-size: 1.5rem;
            color: #4B0082;
            text-align: center;
            margin-top: 15px;
        }

        .submit-btn {
            width: 100%;
            padding: 10px;
            background-color: #FFD700;
            color: #4B0082;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
        }

        .submit-btn:hover {
            background-color: #E6BE8A;
        }

        select {
            flex: 0.6;
            width: 100%;
            /* Adjust width */
            height: 28px;
            /* Adjust height */
            padding: 5px;
            /* Add padding for better appearance */
            border: 1px solid gray;
            border-radius: 5px;
            font-size: 13px;
            /* Control text size within the dropdown */
            color: gray;
            /* Text color */
            background-color: #FFFFFF;
            /* Background color */
            font-family: Georgia;
        }

        select:focus,
        select:valid {
            color: black;
        }

        footer {
            text-align: center;
            padding: 10px;
            margin-top: 20px;
            background-color: #6A0DAD;
            color: #FFD700;
        }
    </style>
</head>

<body>
    <header>
        <div class="image-container">
            <img src="PurpleWilly.png" alt="WillyGo Logo" class="header-image" style="width:250px; height: auto;">
        </div>
        <h4 style="font-family:Georgia">Order your McDonald's favorites in seconds!</h4>
    </header>

    <div class="container">
        <header>
            <h1 style="font-family:Georgia"> Enter Your Order BETA</h1>
        </header>
        <div class="image-container">
            <img src="McDonalds.jpg" alt="McDonald's Logo" class="header-image" style="width:130px; height: auto;">
        </div>
        <h3 style="font-family:Georgia; color: #6A0DAD; text-align: center;"> Hours of Operation:</h3>
        <h4 style="font-family:Georgia; color: #6A0DAD; text-align: center;"> Friday: 8:00 PM - 2:30 AM</h4>
        <h4 style="font-family:Georgia; color: #6A0DAD; text-align: center;"> Saturday: 8:00 PM - 2:30 AM</h4>
        <hr>
        <div class="form-group">
            <label for="Name">Name:</label>
            <input placeholder="Enter Name">
        </div>
        <div class="form-group">
            <label for="Dorm">Dorm:</label>
            <select id="Dorm" name="Dorm" required>
                <option value="" disabled selected>Select Your Dorm</option>
                <option value="Dorm1">Agard</option>
                <option value="Dorm2">Brooks</option>
                <option value="Dorm3">Bryant</option>
                <option value="Dorm4">Carter</option>
                <option value="Dorm1">Currier</option>
                <option value="Dorm5">Dodd</option>
                <option value="Dorm1">East</option>
                <option value="Dorm1">Fayerweather</option>
                <option value="Dorm1">Fitch</option>
                <option value="Dorm1">Garfield</option>
                <option value="Dorm2">Gladden</option>
                <option value="Dorm3">Goodrich</option>
                <option value="Dorm4">Horn</option>
                <option value="Dorm5">Hubbell</option>
                <option value="Dorm1">Lehman</option>
                <option value="Dorm2">Mark Hopkins</option>
                <option value="Dorm3">Mission</option>
                <option value="Dorm4">Morgan</option>
                <option value="Dorm5">Perry</option>
                <option value="Dorm1">Prospect</option>
                <option value="Dorm1">Sage</option>
                <option value="Dorm1">Sewall</option>
                <option value="Dorm2">Specer</option>
                <option value="Dorm3">Thompson</option>
                <option value="Dorm4">Tyler</option>
                <option value="Dorm5">Tyler Annex</option>
                <option value="Dorm1">West</option>
                <option value="Dorm1">Williams (Willy)</option>
                <option value="Dorm2">Wood</option>
            </select>

        </div>
        <div class="form-group">
            <label for="Phone Number">Phone Number:</label>
            <input placeholder="Enter Phone Number">
        </div>
        <form id="orderForm" action="/netlify/functions/create-checkout-session" method="POST">
            <table class="menu-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Size</th>
                        <th>Quantity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="3" style="text-align: left; font-weight: bold; font-size: 1.1em; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Burgers
                        </td>
                    </tr>
                    <tr>
                        <td>Big Mac</td>
                        <td>-</td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('bigMac', -1)">-</button>
                                <input type="number" id="bigMac" name="bigMac" placeholder="0" value="0" min="0"
                                    data-price="5.99" readonly>
                                <button type="button" onclick="adjustQuantity('bigMac', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Quarter Pounder</td>
                        <td>-</td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('quarterPounder', -1)">-</button>
                                <input type="number" id="quarterPounder" name="quarterPounder" placeholder="0" value="0" min="0"
                                    data-price="7.09" readonly>
                                <button type="button" onclick="adjustQuantity('quarterPounder', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Double Quarter Pounder</td>
                        <td>-</td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('doubleQuarterPounder', -1)">-</button>
                                <input type="number" id="doubleQuarterPounder" name="doubleQuarterPounder" placeholder="0" value="0" min="0"
                                    data-price="7.99" readonly>
                                <button type="button" onclick="adjustQuantity('doubleQuarterPounder', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>McCrispy</td>
                        <td>-</td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('mcCrispy', -1)">-</button>
                                <input type="number" id="mcCrispy" name="mcCrispy" placeholder="0" value="0" min="0"
                                    data-price="7.99" readonly>
                                <button type="button" onclick="adjustQuantity('mcCrispy', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>Fries</td>
                        <td>
                            <select id="friesSize" onchange="updatePriceAndQuantity('fries', 'friesSize')">
                                <option value="4.79" data-size="small">Small ($4.79)</option>
                                <option value="5.79" data-size="medium">Medium ($5.79)</option>
                                <option value="7.09" data-size="large">Large ($7.09)</option>
                            </select>
                        </td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('fries', -1)">-</button>
                                <input type="number" id="fries" name="fries" placeholder="0" min="0" value="0"
                                    size="small" data-price="4.79" readonly>
                                <button type="button" onclick="adjustQuantity('fries', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>McNuggets</td>
                        <td>
                            <select id="mcNuggetsSize" onchange="updatePriceAndQuantity('mcNuggets', 'mcNuggetsSize')
                            ">
                                <option value="6.79" data-size="4pc">4pc ($6.79)</option>
                                <option value="8.99" data-size="6pc">6pc ($8.99)</option>
                                <option value="11.89" data-size="10pc">10pc ($11.89)</option>
                            </select>
                        </td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('mcNuggets', -1)">-</button>
                                <input type="number" id="mcNuggets" name="mcNuggets" placeholder="0" min="0" value="0"
                                    size="4pc" data-price="6.79" readonly>
                                <button type="button" onclick="adjustQuantity('mcNuggets', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: left; font-weight: bold; font-size: 1.1em; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Drinks
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select id="sodaFlavor" onchange="updateProductFlavor(soda, sodaFlavor)">
                                <option value="0.99" data-flavor="sprite">Sprite</option>
                                <option value="0.99" data-flavor="cocaCola">Coca Cola</option>
                                <option value="0.99" data-flavor="cokeZero">Coke Zero</option>
                                <option value="0.99" data-flavor="orangeFanta">Orange Fanta</option>
                                <option value="0.99" data-flavor="drPepper">Dr. Pepper</option>
                                <option value="0.99" data-flavor="rootBeer">Root Beer</option>
                                <option value="0.99" data-flavor="lemonade">Lemonade</option>
                            </select>
                        </td>
                        <td>
                            <select id="sodaSize" onchange="updatePriceAndQuantity('soda', 'sodaSize')">
                                <option value="2.19" data-size="small">Small ($2.19)</option>
                                <option value="2.49" data-size="medium">Medium ($2.49)</option>
                                <option value="2.59" data-size="large">Large ($2.59)</option>
                            </select>
                        </td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('soda', -1)">-</button>
                                <input type="number" id="soda" name="soda" placeholder="0" min="0" value="0" +
                                    size="small" data-price="2.19" data-flavor="cocaCola" readonly>
                                <button type="button" onclick="adjustQuantity('soda', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: left; font-weight: bold; font-size: 1.1em; color: #4B0082; background-color: #E6E6FA; padding: 10px; border-radius: 10px;">
                            Sweets
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select id="mcflurryFlavor" onchange="updateProductFlavor(mcflurry, mcflurryFlavor)">
                                <option value="6.59" data-flavor="oreoMcFlurry">Oreo McFlurry</option>
                                <option value="6.59" data-flavor="m&MMcFlurry">M&M McFlurry</option>
                                <option value="6.59" data-flavor="oreoShamrockMcFlurry">Shamrock Oreo McFlurry</option>
                            </select>
                        </td>
                        <td>
                            <select id="mcflurrySize" onchange="updatePriceAndQuantity('mcflurry', 'mcflurrySize')">
                                <option value="6.59" data-size="standard">Standard ($6.59)</option>
                                <option value="4.19" data-size="mini">Mini ($4.19)</option>
                            </select>
                        </td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('mcflurry', -1)">-</button>
                                <input type="number" id="mcflurry" name="mcflurry" placeholder="0" min="0" value="0" +
                                    size="standard" data-price="6.59" data-flavor="oreoMcFlurry" readonly>
                                <button type="button" onclick="adjustQuantity('mcflurry', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <select id="shakeFlavor" onchange="updateProductFlavor(shake, shakeFlavor)">
                                <option value="5.59" data-flavor="chocolateShake">Chocolate Shake</option>
                                <option value="6.19" data-flavor="vanillaShake">Vanilla Shake</option>
                                <option value="6.59" data-flavor="strawberryShake">Strawberry Shake</option>
                            </select>
                        </td>
                        <td>
                            <select id="shakeSize" onchange="updatePriceAndQuantity('shake', 'shakeSize')">
                                <option value="5.59" data-size="small">Small ($5.59)</option>
                                <option value="6.19" data-size="medium">Medium ($6.19)</option>
                                <option value="6.59" data-size="large">Large ($6.59)</option>
                            </select>
                        </td>
                        <td>
                            <div class="quantity-wrapper">
                                <button type="button" onclick="adjustQuantity('shake', -1)">-</button>
                                <input type="number" id="shake" name="shake" placeholder="0" min="0" value="0" +
                                    size="small" data-price="5.59" data-flavor="chocolate" readonly>
                                <button type="button" onclick="adjustQuantity('shake', 1)">+</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <h3 style="font-family:Georgia;color: #6A0DAD;">Current Cart</h3>
            <ul id="cartItems"></ul>
            <div id="totalCost"></div>
            <hr>
            <button type="button" class="submit-btn" id = "checkout-button" onclick="submitOrder(event)">Submit Order</button>
        </form>

    </div>

    <footer>
        <p>© 2025 Willy2Go</p>
    </footer>

    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://checkout.stripe.com/checkout.js"></script>
    <script>
        // General object to store product quantities
        const cart = {};

        function updateProductFlavor(product,productFlavor) {
            const productFlavorSelect = document.getElementById(productFlavor);
            productFlavorSelect.addEventListener("change", function () {
                const selectedFlavorOption = this.options[this.selectedIndex];
                const flavor = selectedFlavorOption.getAttribute("data-flavor"); // Get selected flavor
                const sodaInput = document.getElementById(product);

                // Update the name attribute dynamically based on flavor
                const newItemId = `${product}_${flavor}`;
                sodaInput.name = newItemId;

                // Fetch the current selected size
                const productSizeSelect = document.getElementById(product+"Size");
                const selectedSizeOption = productSizeSelect.options[productSizeSelect.selectedIndex];
                const size = selectedSizeOption.getAttribute("data-size");

                // Reset quantity to 0 if switching to a new flavor
                if (!(newItemId in cart) || !(size in cart[newItemId])) {
                    sodaInput.value = 0;
                } else {
                    sodaInput.value = cart[newItemId][size].quantity; // Retrieve quantity from cart if exists
                }

                // Ensure cart is structured correctly for new flavor
                if (!(newItemId in cart)) {
                    cart[newItemId] = {};
                }
                if (!(size in cart[newItemId])) {
                    cart[newItemId][size] = { price: parseFloat(selectedSizeOption.value), quantity: 0 };
                }

                // Update price and quantity based on size
                updatePriceAndQuantity(newItemId, product+"Size");
            });
        }

        // Ensure the function runs on page load to initialize correct values
        updateProductFlavor();

        function updatePriceAndQuantity(itemId, itemSizeId) {
            const optionElement = document.getElementById(itemSizeId);
            const selectedOption = optionElement.options[optionElement.selectedIndex];
            const value = parseFloat(selectedOption.value);  // Price of the selected size
            const size = selectedOption.getAttribute('data-size');  // Size (like '10pc', '20pc', etc.)

            const itemElement = document.getElementById(itemId);
            const itemKey = itemElement.name;  // Use the name attribute as the key
            itemElement.setAttribute('data-price', value);  // Update price

            if (!(itemKey in cart)) {
                cart[itemKey] = {};
            }

            // Initialize the size with quantity 0 if not present in cart
            if (!(size in cart[itemKey])) {
                cart[itemKey][size] = { "price": value, "quantity": 0 };
            }

            // Set input field value to the quantity stored in cart
            itemElement.value = cart[itemKey][size].quantity;
        }

        function adjustQuantity(itemId, quantityChange) {
            const inputElement = document.getElementById(itemId);
            let currentValue = parseInt(inputElement.value, 10);  // Convert the current value to a number
            currentValue += quantityChange;   // Adjust the value by quantity change
            inputElement.value = currentValue;  // Update the input's value

            updateCart(itemId);
        }


        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItems');
            cartItemsList.innerHTML = ''; // Clear the previous list

            for (let itemKey in cart) {
                const itemData = cart[itemKey];

                if (!('quantity' in itemData)) {
                    // For size-based items like fries and McNuggets
                    for (let size in itemData) {
                        const sizeData = itemData[size];
                        if (sizeData.quantity > 0) { // Only display if quantity is greater than 0
                            const capitalizedSize = size.charAt(0).toUpperCase() + size.slice(1); // Capitalize size
                            const li = document.createElement('li');
                            li.textContent = `${capitalizedSize} ${formatItemName(itemKey)}: ${sizeData.quantity} x $${sizeData.price.toFixed(2)}`;
                            cartItemsList.appendChild(li);
                        }
                    }
                } else {
                    if (itemData.quantity > 0) { // Only display if quantity is greater than 0
                        const li = document.createElement('li');
                        li.textContent = `${formatItemName(itemKey)}: ${itemData.quantity} x $${itemData.price.toFixed(2)}`;
                        cartItemsList.appendChild(li);
                    }
                }
            }

            updateTotalCost();
        }

        // Helper function to format item names (capitalize first letter)
        function formatItemName(itemKey) {
            // Split the itemKey by underscores (assumed to be in "category_name" format)
            const parts = itemKey.split('_');

            // If the name has multiple parts (e.g., "soda_cocaCola"), remove the first part
            if (parts.length > 1) {
                return parts.slice(1).map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
            }

            // If the name is a single word (e.g., "bigMac"), just capitalize it
            return parts[0].charAt(0).toUpperCase() + parts[0].slice(1);
        }


        function updateCart(itemId) {
            const inputElement = document.getElementById(itemId);
            const quantity = parseInt(inputElement.value, 10) || 0;
            const price = parseFloat(inputElement.getAttribute("data-price")) || 0;

            if (inputElement.hasAttribute("size")) {
                // Handle size-based items
                const sizeDropdownId = itemId + "Size";
                const sizeDropdown = document.getElementById(sizeDropdownId);
                const selectedOption = sizeDropdown.options[sizeDropdown.selectedIndex];
                const size = selectedOption.getAttribute("data-size");

                // Check for soda flavor
                if (itemId === "soda") {
                    const sodaFlavorDropdown = document.getElementById("sodaFlavor");
                    const selectedFlavorOption = sodaFlavorDropdown.options[sodaFlavorDropdown.selectedIndex];
                    const flavor = selectedFlavorOption.getAttribute("data-flavor");
                    itemId = `soda_${flavor}`;
                }

                if (itemId === "mcflurry") {
                    const mcflurryFlavorDropdown = document.getElementById("mcflurryFlavor");
                    const selectedFlavorOption = mcflurryFlavorDropdown.options[mcflurryFlavorDropdown.selectedIndex];
                    const flavor = selectedFlavorOption.getAttribute("data-flavor");
                    itemId = `mcflurry_${flavor}`;
                }

                if (itemId === "shake") {
                    const shakeFlavorDropdown = document.getElementById("shakeFlavor");
                    const selectedFlavorOption = shakeFlavorDropdown.options[shakeFlavorDropdown.selectedIndex];
                    const flavor = selectedFlavorOption.getAttribute("data-flavor");
                    itemId = `shake_${flavor}`;
                }

                if (itemId === "quarterPounder") {
                    const quarterPounderFlavorDropdown = document.getElementById("quarterPounderFlavor");
                    const selectedFlavorOption = quarterPounderFlavorDropdown.options[quarterPounderFlavorDropdown.selectedIndex];
                    const flavor = selectedFlavorOption.getAttribute("data-flavor");
                    itemId = `quarterPounder_${flavor}`;
                }

                if (!(itemId in cart)) {
                    cart[itemId] = {};
                }

                cart[itemId][size] = {
                    price: price,
                    quantity: quantity
                };
            } else {
                // Handle items without size variations
                cart[itemId] = {
                    price: price,
                    quantity: quantity
                };
            }

            updateCartDisplay();
        }


        function calculateFee(totalPrice) {
            if (totalPrice <= 10) {
                return 4.00;
            } else if (totalPrice <= 20) {
                return 5.50;
            } else if (totalPrice <= 30) {
                return 6.00;
            } else if (totalPrice <= 40) {
                return 8.00;
            } else {
                return 10.00;
            }
        }


        function updateTotalCost() {
            let subTotal = 0;

            // Iterate through the cart to calculate the subtotal
            for (let itemKey in cart) { // Use itemKey (which is now the name attribute)
                const itemData = cart[itemKey];

                if (itemData.quantity !== undefined && itemData.price !== undefined) {
                    subTotal += itemData.quantity * itemData.price;
                } else {
                    for (let size in itemData) {
                        const sizeData = itemData[size];
                        subTotal += sizeData.quantity * sizeData.price;
                    }
                }
            }

            const fee = calculateFee(subTotal);
            const total = subTotal + fee;

            if (total > 0) {
                document.getElementById('totalCost').innerText =
                    `Subtotal: $${subTotal.toFixed(2)} | Fee: $${fee.toFixed(2)} | Total: $${total.toFixed(2)}`;
            } else {
                document.getElementById('totalCost').innerText = '';
            }
        }


        function submitOrder(event) {
            // event.preventDefault();
            document.getElementById('orderForm').submit();
            const form = document.getElementById('orderForm');

            form.addEventListener('submit', async (event) => {
                event.preventDefault(); // Prevent default form submission

                const formData = new FormData(form);
                const data = {};
                formData.forEach((value, key) => {
                    data[key] = value;
                });

                try {
                    const response = await fetch('/.netlify/functions/create-checkout-session', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    if (response.ok) {
                        const result = await response.json();  // Parse JSON response
                        window.location.href = result.redirect_url;  // Redirect

                    } else {
                        console.error('Form submission failed:', response.status, response.statusText);
                        alert(`Form submission failed: ${response.status} ${response.statusText}`);
                    }
                } catch (error) {
                    console.error('Network error occurred:', error);
                    alert(`Network error occurred: ${error.message}`);
                }
            });
        }
    </script>

</body>

</html>